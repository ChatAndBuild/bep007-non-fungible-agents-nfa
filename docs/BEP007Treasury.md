# BEP007Treasury

## Overview
The BEP007Treasury contract manages the financial aspects of the BEP-007 ecosystem, handling fee collection and distribution between the protocol treasury and agent owners. It provides a transparent and configurable fee structure for ecosystem sustainability.

## Key Features
- Fee collection and distribution mechanism
- Configurable fee percentages
- Secure fund management
- Governance-controlled withdrawals

## Contract Structure

### State Variables
- `governance`: Address of the governance contract
- `treasuryFeePercentage`: Percentage of fees kept by treasury (in basis points)
- `ownerFeePercentage`: Percentage of fees distributed to agent owners (in basis points)
- `totalBnbBalance`: Total BNB balance held by the treasury

### Events
- `FeesDistributed`: Emitted when fees are distributed
- `FeePercentagesUpdated`: Emitted when fee percentages are updated
- `FundsWithdrawn`: Emitted when funds are withdrawn from the treasury

### Functions

#### Initialization
```solidity
function initialize(
    address _governance,
    uint256 _treasuryFeePercentage,
    uint256 _ownerFeePercentage
) public initializer
```
Initializes the contract with governance address and fee percentages.

#### Fee Management
```solidity
function distributeFees(address agentOwner) external payable nonReentrant
```
Distributes incoming fees between the treasury and the agent owner.

```solidity
function updateFeePercentages(
    uint256 _treasuryFeePercentage,
    uint256 _ownerFeePercentage
) external onlyOwner
```
Updates the fee percentages for treasury and agent owners.

#### Fund Management
```solidity
function withdrawFunds(address recipient, uint256 amount) external onlyGovernance nonReentrant
```
Withdraws funds from the treasury to a specified recipient.

#### Configuration
```solidity
function setGovernance(address _governance) external onlyOwner
```
Updates the governance address.

## Security Considerations
- Reentrancy protection for all fund transfers
- Strict validation of fee percentages (must sum to ≤ 100%)
- Governance-controlled withdrawals
- Balance tracking to prevent overdrafts

## Integration Points
- Receives fees from agent operations
- Distributes portions to agent owners
- Controlled by BEP007Governance for fund management

## Fee Structure
The treasury uses a basis point system for fee calculation:
- 10,000 basis points = 100%
- Fee percentages are configurable but must sum to ≤ 100%
- Default distribution typically allocates:
  - A portion to the protocol treasury for ongoing development and maintenance
  - A portion to agent owners as incentive for creating valuable agents

## Use Cases
1. **Protocol Sustainability**: Collect fees to fund ongoing development and maintenance
2. **Creator Incentives**: Reward agent creators with a portion of the fees generated by their agents
3. **Ecosystem Growth**: Fund grants, hackathons, and other initiatives to grow the ecosystem
4. **Governance Rewards**: Distribute rewards to governance participants

## Example Configuration
```
Treasury Configuration {
  treasuryFeePercentage: 2000,  // 20% to protocol treasury
  ownerFeePercentage: 8000      // 80% to agent owners
}
```

## Governance Controls
The treasury is controlled by the governance contract, which can:
- Update fee percentages
- Withdraw funds for approved purposes
- Change the governance address

This ensures that treasury management is transparent and controlled by the community through the governance process.
